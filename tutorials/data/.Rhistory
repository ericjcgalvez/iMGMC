knitr::opts_chunk$set(fig.width=10, fig.height=8,
warning=FALSE)
# library
library("reshape2")
library("ggplot2")
library("ggpubr")
library("tidyquant")
library("dplyr")
# Please set file locations and parameters:
my_abundances <- read.csv("abundances-PRJNA390686.txt" , header = TRUE , sep = "\t")
my_SampleMetaData <- read.csv("MetaDATA-PRJNA390686.txt" , header = TRUE , sep = "\t")
#raw_num_contig <- read.csv("num_contigs.tsv" , header = TRUE , sep = "\t")
#raw_Genome_coverage <- read.csv("coverages10_15.tsv" , header = FALSE , sep = "\t")
# Please set file locations and parameters:
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
#### remove unmapped and MAGs with no mapping:
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% "unmapped", ]
matrix_abundances_no_zeros <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
#### no zeros:
matrix_abundances_sd <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd)
################go here
KeggModules_Lib_mat=as.matrix(KeggModules_Lib[,-1])
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
matrix_abundances_mean <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){mean(x)}>0.1))),]
heatmap(matrix_abundances_mean)
matrix_abundances_mean <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean)
matrix_abundances_mean <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){mean(x)}<0.5))),]
heatmap(matrix_abundances_mean)
matrix_abundances_mean <- matrix_abundances[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.5))),]
heatmap(matrix_abundances_mean)
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
matrix_abundances_mean <- matrix_abundances[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.5))),]
heatmap(matrix_abundances_mean)
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.5))),]
heatmap(matrix_abundances_mean)
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances[-(which(apply(matrix_abundances,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd)
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.5))),]
heatmap(matrix_abundances_mean)
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean)
my_SampleMetaData <- read.csv("MetaDATA-PRJNA390686.txt" , header = TRUE , sep = "\t")
Sample_Color <- as.vector(cbind(my_SampleMetaData$SRA,my_SampleMetaData$Color))
Sample_Color <- cbind(my_SampleMetaData$SRA,my_SampleMetaData$Color)
View(Sample_Color)
View(Sample_Color)
my_SampleMetaData$SRA
my_SampleMetaData$Color
heatmap(matrix_abundances_sd , ColSideColors=my_SampleMetaData$Color)
my_SampleMetaData$Color
heatmap(matrix_abundances_sd , ColSideColors=as.vector(my_SampleMetaData$Color))
knitr::opts_chunk$set(fig.width=10, fig.height=8,
warning=FALSE)
# library
library("reshape2")
library("ggplot2")
library("ggpubr")
library("tidyquant")
library("dplyr")
# Please set file locations and parameters:
my_abundances <- read.csv("abundances-PRJNA390686.txt" , header = TRUE , sep = "\t")
my_SampleMetaData <- read.csv("MetaDATA-PRJNA390686.txt" , header = TRUE , sep = "\t")
#raw_num_contig <- read.csv("num_contigs.tsv" , header = TRUE , sep = "\t")
#raw_Genome_coverage <- read.csv("coverages10_15.tsv" , header = FALSE , sep = "\t")
Sample_Color <- cbind(my_SampleMetaData$SRA,my_SampleMetaData$Color)
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
heatmap(matrix_abundances)
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd , ColSideColors=as.vector(my_SampleMetaData$Color))
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
my_abundances <- read.csv("abundances-PRJNA390686-withTaxonomy.txt" , header = TRUE , sep = "\t")
my_SampleMetaData <- read.csv("MetaDATA-PRJNA390686.txt" , header = TRUE , sep = "\t")
Sample_Color <- cbind(my_SampleMetaData$SRA,my_SampleMetaData$Color)
## Heatmap for all MAGs:
```{r  echo=T}
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
pdf("headmap_abundances_mean.pdf",width = 10,height = 6)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
dev.off()
dev.off()
pdf("headmap_abundances_mean.pdf",width = 10,height = 6)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
pdf("headmap_abundances_mean.pdf",width = 10,height = 6,onefile=FALSE)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
pdf("headmap_abundances_mean.pdf",width = 10,height = 6,onefile=FALSE)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
# Please set file locations and parameters:
my_abundances <- read.csv("abundances-PRJNA390686.txt" , header = TRUE , sep = "\t")
my_abundances <- read.csv("abundances-PRJNA390686-withTaxonomy.txt" , header = TRUE , sep = "\t")
my_SampleMetaData <- read.csv("MetaDATA-PRJNA390686.txt" , header = TRUE , sep = "\t")
#raw_num_contig <- read.csv("num_contigs.tsv" , header = TRUE , sep = "\t")
#raw_Genome_coverage <- read.csv("coverages10_15.tsv" , header = FALSE , sep = "\t")
Sample_Color <- cbind(my_SampleMetaData$SRA,my_SampleMetaData$Color)
# Please set file locations and parameters:
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
#### remove unmapped and MAGs with no mapping:
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
#### SD :
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd , ColSideColors=as.vector(my_SampleMetaData$Color))
#### mean :
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
#####
pdf("headmap_abundances_mean.pdf",width = 10,height = 6,onefile=FALSE)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
pdf("headmap_abundances_mean.pdf",width = 12,height = 6,onefile=FALSE)
dev.off()
#### mean :
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
#####
pdf("headmap_abundances_mean.pdf",width = 12,height = 6,onefile=FALSE)
pdf("headmap_abundances_mean12.pdf",width = 12,height = 6,onefile=FALSE)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
# Please set file locations and parameters:
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
#### remove unmapped and MAGs with no mapping:
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
#### SD :
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd , ColSideColors=as.vector(my_SampleMetaData$Color))
#### mean :
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
#####
pdf("headmap_abundances_mean12.pdf",width = 12,height = 6,onefile=FALSE)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
################go here
KeggModules_Lib_mat=as.matrix(KeggModules_Lib[,-1])
knitr::opts_chunk$set(fig.width=10, fig.height=8,
warning=FALSE)
# library
library("reshape2")
library("ggplot2")
library("ggpubr")
library("tidyquant")
library("dplyr")
# Please set file locations and parameters:
my_abundances <- read.csv("abundances-PRJNA390686.txt" , header = TRUE , sep = "\t")
my_abundances <- read.csv("abundances-PRJNA390686-withTaxonomy.txt" , header = TRUE , sep = "\t")
my_SampleMetaData <- read.csv("MetaDATA-PRJNA390686.txt" , header = TRUE , sep = "\t")
#raw_num_contig <- read.csv("num_contigs.tsv" , header = TRUE , sep = "\t")
#raw_Genome_coverage <- read.csv("coverages10_15.tsv" , header = FALSE , sep = "\t")
Sample_Color <- cbind(my_SampleMetaData$SRA,my_SampleMetaData$Color)
# Please set file locations and parameters:
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
#### remove unmapped and MAGs with no mapping:
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
#### SD :
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd , ColSideColors=as.vector(my_SampleMetaData$Color))
#### mean :
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
#####
pdf("headmap_abundances_mean12.pdf",width = 12,height = 6,onefile=FALSE)
# Please set file locations and parameters:
matrix_abundances <- as.matrix(my_abundances[,-1])
rownames(matrix_abundances)=my_abundances[,1]
heatmap(matrix_abundances)
#### remove unmapped and MAGs with no mapping:
matrix_abundances_no_zeros <- matrix_abundances[!rownames(matrix_abundances) %in% c("unmapped"), ]
matrix_abundances_no_zeros <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){all(x==0)})==T)),]
heatmap(matrix_abundances_no_zeros)
#### SD :
matrix_abundances_sd <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){sd(x)}<=0.6))),]
heatmap(matrix_abundances_sd , ColSideColors=as.vector(my_SampleMetaData$Color))
#### mean :
matrix_abundances_mean <- matrix_abundances_no_zeros[-(which(apply(matrix_abundances_no_zeros,1,function(x){mean(x)}<0.1))),]
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
#####
pdf("headmap_abundances_mean2.pdf",width = 12,height = 6,onefile=FALSE)
heatmap(matrix_abundances_mean , ColSideColors=as.vector(my_SampleMetaData$Color))
dev.off()
